name: Weekly-Fusion Crime Brief

on:
  schedule:
    - cron: '0 3 * * 0'          # 03:00 UTC = 06:00 EAT (Sun)
  workflow_dispatch:             # manual trigger button

jobs:
  weekly-fusion:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'
          cache: 'pip'

      - run: pip install -r requirements.txt

      - name: Collate & analyse last 6 full days
        run: python src/analyst/weekly_fusion.py

      - name: Render HTML + PDF
        run: python src/render/pdf.py   # already exists – just points at new HTML

      - name: Send e-mail
        run: python src/render/email.py  # already exists – re-uses same secrets
